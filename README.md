# Precision-of-Full-spectrum-fitting-Reddening
This set of Python scripts is created by Niveditha Parthasarathy. The project consists of four Python source files, each designed to perform a distinct task related to data extraction, processing, and analysis. The aim of this project is to explore the precision of full-spectrum fitting of star clusters, in particular, to quantify the errors associated with reddening results.

# Python Source Files
## 1. model_file_creation.py

Purpose: 

This code processes spectral data from multiple model files, compiles it into a single dataframe, and then exports the compiled data to a text file compatible with the Analyzer of Spectra for Age Determination.

It takes 23 model spectra files corresponding to different ages within 6.0 < log (age/yr) < 10.1. The wavelength range of the compiled model is adjusted from the initial range 91 Å -1,600,000 Å to 3700 Å -5000 Å.

Key Functions:
- read_file: Reads and processes spectral data files.
- create_model: Writes the compiled data to a text file.


## 2. sample_creation.py

Purpose: This script generates sample data for analysis. It includes functions to create and manipulate sample datasets.

Key Functions:

### REDDENING
- get_A_v(EBV): Calculates the total extinction in the V-band based on the extinction parameter and color excess.
- wavelength_to_y(wavelength): Converts wavelength from Angstroms to a y value used in the Cardelli et al. (1989) extinction formula.
- calculate_A(wavelength): Calculates the total extinction at each wavelength using the Cardelli et al. (1989) formula.
- new_flux(x0): Calculates the reddened flux for each wavelength based on the original flux and extinction values.
- add_reddening(x0, y0, level): Takes the original wavelength, flux, and E(B-V) value, calculates the reddened flux for each wavelength, and returns a list of reddened flux values.
- create_reddened_files(data, str): Reads a model file, calculates reddened spectra for different E(B-V) values, and saves them to separate files.
- plot_reddened(): Plots the reddened spectra for each E(B-V) value. (This function is commented out in the provided code)


## NOISE

- add_noise(flux, noise_mean): Adds Gaussian noise to the flux values based on a specified mean value.
- create_noise_reddened_files(str, num_duplicates): Creates noisy versions of the reddened spectra with different noise levels and saves them to separate files.
- read_file(filename, skiplines, separator): Reads a data file, skips specified lines, and returns a pandas DataFrame with columns for wavelength and flux.
- write_lists_to_file(x_list, y_list, filename): Writes two lists (wavelength and flux) to a specified file.
- setting_plot_parameters_and_display(): Sets plot parameters like axis limits, labels, and title. (This function is commented out in the provided code)
- read_model_file(filename, skiplines, separator): Reads a model file, creates column names based on the header line, and returns a pandas DataFrame with columns for wavelength and flux for all ages, along with a list of ages. further analysis.


## 3. creating_excels.py

Purpose: This script reads results from text files generated by the Analyzer of Spectra for Age Determination and stores them in an Excel file.

Key Features:

- Reads results from multiple text files (results_1.txt to results_20.txt by default).
- Extracts relevant information: Test_Age, Reddening, SNR, Retrieved_age, Retrieved_reddening.
- Creates a pandas DataFrame to store the extracted data.
- Cleans and prepares the data:
    - Assigns column names.
    - Converts data types to floats.
    - Adjusts Reddening and SNR values as needed.
- Sorts the DataFrame by Reddening values.
- Appends the sorted data to an existing Excel file ("Compiled_results.xlsx") or creates a new file if it doesn't exist.
- Writes the final DataFrame to the Excel file.


## 4. analysis.py

Purpose: This script helps in the visualization of results data and constructing a comprehensive error table for each SNR, age and reddening combination.

Key Features:

- This code reads the excel file containing all the results data and creates
different plots for analyzing the retrieved reddening. 
- The code for plots used in the thesis are provided first, followed by code for creating an excel sheet with the percentage error of retrieved reddening across all SNRs, ages and reddening. 
- Code for some supplementary plots is provided
- This code requires the excel sheet to be saved in the same directory as its source code


Usage:

Run the scripts individually according to their specific tasks and adjust the function parameters and input data as needed.
